---
title: real-world프로젝트 Spring 시작하기(3) - AutoTest gitAction적용, 설명
author: 
    name: minseok
    link: https://github.com/kkminseok
date: 2022-09-15 01:02:00 +0800
categories: [Toy,real-world-spring]
tags: [Spring]
math: true
mermaid: true
image: 
    path: /assets/img/realworld/realworldLogo.png
comments: true
---

> [real-world project 구현 과정 카테고리 보기](https://kkminseok.github.io/categories/real-world-spring/)
{: .prompt-info}


저번 포스팅때 API구현을 한다고 하였지만, 이미 구현한 상태에서 느끼기엔 언젠가 Git Action을 쓸 거 지금 미리쓰면 좋다고 생각하였다.

이게 선행되어야된다고 생각하고 만약 다시 만든다면 CI구축을 할 것이므로 API구현보다 빠른 순서에 넣었다.

간단한 GitAction에 대해서는 큰 공부 필요없이 도큐읽고 작성하면 된다.

템플릿도 제공하고 있으니.. 참고하자.

먼저 코드를 보면

```yml
name: auto test java

on:
  push:
    branches: [ "master" ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Java JDK
        uses: actions/setup-java@v3.5.0
        with:
          distribution: 'temurin'
          java-version: '18'
          
      - name: Grant execute permission gradlew
        run: chmod +x gradlew
        
      - name: Build
        run: ./gradlew build -x test
      
      - name: Test
        run: SPRING_PROFILES_ACTIVE=[test] ./gradlew test
      
      - name: Publish Unit Test Results
        uses: EnricoMi/publish-unit-test-result-action@v1
        if: ${{ always() }}
        with:
          files: build/test-results/**/*.xml
```

위에서 부터 하나씩 공부해보았다.

- `name` : 작성하지 않아도 된다. 이 전체 흐름인 워크플로우의 이름이다. 공식문서에 따르면 작성을 하지 않으면 `root`기준의 파일경로가 워크플로우의 이름이 된다고 한다. 작성시에는

![](/assets/img/realworld/workflow_name.png)


- `on:push:branches` : 워크플로우가 작동하는 이벤트를 정의하는 구문이다. `on`이 달려있으면 그 뒤에는 트리거 역할을 한다. 뒤에 있는 `push`와 `branches`는 트리거를 작동시키는 조건인 것이다. 위의 코드에서는 마스터 브런치가, push했을때 이 트리거를 작동시키게 설정해놨다.

- `jobs` : workflow가 작동시킬 일들을 정의한다. 따로 지정하지 않으면 병렬적으로 수행된다고 한다. 해당 프로젝트에서는 여러 job을 지정하지 않을것이므로 알아만 두었다.
    - `build` : build는 문법이 아니다. 보통 당연하게 jobs:build:~로 해놔서 여기까지 문법인줄 알았는데 그게 아니고 **job의 unique**한 이름이다. 즉, build라는 이름을 지정해준것. 그래서 build라고 지정하지 않고 **realworld_test**로 지정해보았다. 
    ![](/assets/img/realworld/workflow_job_name.png)
    느낌이 확 온다. 
        - 'runs-on` : 간단하게 구동될 환경을 설정한다. 윈도우, 맥환경도 가능하다. 보통 리눅스환경에서 돌리므로 **ubuntu-latest**로 지정하였다.

        - `steps` : 앞으로 지정해줄 연속적인 task들을 말한다. `run`이라는 명령어를 통해 task들을 만들 수 있다. **모든 run들이 동작하지 않을 수 있지만, 모든 run들은 steps안에서 실행되어야 한다.** 당장 위의 코드만 봐도 `run`이 없는 `steps`들이 있다. 

작성중..