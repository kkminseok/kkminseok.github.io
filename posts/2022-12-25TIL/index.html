<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Java,OS- 동시성 정리" /><meta name="author" content="minseok" /><meta property="og:locale" content="ko" /><meta name="description" content="🔅 동시성 개요" /><meta property="og:description" content="🔅 동시성 개요" /><link rel="canonical" href="https://kkminseok.github.io/posts/2022-12-25TIL/" /><meta property="og:url" content="https://kkminseok.github.io/posts/2022-12-25TIL/" /><meta property="og:site_name" content="민석강" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-25T01:02:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Java,OS- 동시성 정리" /><meta name="twitter:site" content="@none" /><meta name="twitter:creator" content="@minseok" /><meta name="google-site-verification" content="_icgy_j24DLYroQvKYTiffcqemP7ldWCxmrM2cGtYck" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"minseok"},"dateModified":"2022-12-25T01:02:00+09:00","datePublished":"2022-12-25T01:02:00+09:00","description":"🔅 동시성 개요","headline":"Java,OS- 동시성 정리","mainEntityOfPage":{"@type":"WebPage","@id":"https://kkminseok.github.io/posts/2022-12-25TIL/"},"url":"https://kkminseok.github.io/posts/2022-12-25TIL/"}</script><title>Java,OS- 동시성 정리 | 민석강</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="민석강"><meta name="application-name" content="민석강"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/sample/logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">민석강</a></div><div class="site-subtitle font-italic">3년차 개발자. 40살에 100억벌고 은퇴</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/kkminseok" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/none" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['minseok19950727','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Java,OS- 동시성 정리</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Java,OS- 동시성 정리</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/kkminseok">minseok</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1671897720" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-12-25 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3213 words"> <em>17 min</em> read</span></div></div></div><div class="post-content"><h1 id="-동시성-개요">🔅 동시성 개요</h1><p>앞에서 프로세스끼리 데이터를 공유하려면 <strong>share-memory</strong>기법이나 <strong>message passing</strong>기법을 사용하였다.</p><p>공유된 데이터를 사용하려면 항상 동시성을 생각해야하는데, 데이터 불일치라는 문제가 생길 수 있기 때문이다.</p><p>그래서 프로세스나 쓰레드의 실행 순서를 보장해주는 등의 작업을 해줘야한다.</p><hr /><h2 id="-입출금-예제"><span class="mr-2">🔑 입출금 예제</span><a href="#-입출금-예제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>간단한 예제로는 입출금 예제가 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestClass</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Account</span><span class="o">(</span><span class="mi">100000</span><span class="o">);</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">accountExample</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span><span class="o">,</span> <span class="nc">ExecutionException</span> <span class="o">{</span>
        <span class="nc">ExecutorService</span> <span class="n">executor</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="c1">//virtual Thread 아직 intellij에서 지원안함. (preview)</span>
        <span class="c1">//ExecutorService executor = Executors.newVirtualThreadPerTaskExecutor();</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Task</span><span class="o">&gt;</span> <span class="n">tasks</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">tasks</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Task</span><span class="o">((</span><span class="kt">int</span><span class="o">)((</span><span class="nc">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()*</span><span class="mi">3</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="o">,</span> <span class="n">account</span><span class="o">));</span>
        <span class="o">}</span>

        <span class="kt">long</span> <span class="n">time</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">futures</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="na">invokeAll</span><span class="o">(</span><span class="n">tasks</span><span class="o">);</span>

        <span class="kt">long</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">:</span> <span class="n">futures</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sum</span> <span class="o">+=</span> <span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">time</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span> <span class="o">-</span> <span class="n">time</span><span class="o">;</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"sum = "</span> <span class="o">+</span> <span class="n">sum</span> <span class="o">+</span> <span class="s">"; time = "</span> <span class="o">+</span> <span class="n">time</span> <span class="o">+</span> <span class="s">" ms"</span><span class="o">);</span>

        <span class="n">executor</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Account</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">balance</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Account</span><span class="o">(</span><span class="kt">int</span> <span class="n">balance</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">balance</span> <span class="o">=</span> <span class="n">balance</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">withDraw</span><span class="o">(</span><span class="kt">int</span> <span class="n">money</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">balance</span> <span class="o">&gt;=</span> <span class="n">money</span><span class="o">){</span>
            <span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">();</span>
            <span class="n">thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">balance</span> <span class="o">-=</span> <span class="n">money</span><span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
                    <span class="s">"WithDraw Function Thread %s - Task %d finished.%n"</span><span class="o">,</span> <span class="n">thread</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">getBalance</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getBalance</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">balance</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Task</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">money</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Account</span> <span class="n">account</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Task</span><span class="o">(</span><span class="kt">int</span> <span class="n">money</span><span class="o">,</span> <span class="nc">Account</span> <span class="n">account</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">money</span> <span class="o">=</span> <span class="n">money</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">account</span> <span class="o">=</span> <span class="n">account</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
                <span class="s">"Thread %s - Task %d waiting...%n"</span><span class="o">,</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="n">money</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">account</span><span class="o">.</span><span class="na">withDraw</span><span class="o">(</span><span class="n">money</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
                    <span class="s">"Thread %s - Task %d canceled.%n"</span><span class="o">,</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="n">money</span><span class="o">);</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
                <span class="s">"Thread %s - Task %d finished.%n"</span><span class="o">,</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="n">account</span><span class="o">.</span><span class="na">getBalance</span><span class="o">());</span>
        <span class="k">return</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>결과</p><p><img data-src="https://user-images.githubusercontent.com/30401054/209386112-3fca98e1-83da-4fcc-8c9b-15b21f24763d.png" alt="image" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/30401054/209385471-4e2c91b9-cfa1-4c66-bd48-81f87236d666.png" alt="image" data-proofer-ignore></p><p>개발자의 의도와도 다르다. 예측도 거의 불가능. 디버그도 어렵다. 저 코드에서 <code class="language-plaintext highlighter-rouge">thread.sleep(1000)</code>를 지우면 개발자가 원하는대로 돌아가기는 한다. 연산이 간단하기에 추적이나 디버그하는데 시간이 크게 소요되지 않지만 프로그램이 커지면 커질수록 디버그와 추적하기는 어려워진다.</p><p>때문에 동시성을 계속 고려하면서 프로그래밍을 짜거나 논리적 흐름을 구성하는게 정말 중요하다.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>MOV EAX, balance       ; EAX 레지스터에 balance 값 로드
SUB EAX, money      ; EAX에서 money를 뺀 결과를 EAX에 저장
MOV balance, EAX      ; balance에 EAX의 값 대입
</pre></table></code></div></div><blockquote><p>x86아키텍처의 어셈블리어 코드</p></blockquote><p><img data-src="https://user-images.githubusercontent.com/30401054/209426229-5d9cc6ae-418e-46d1-a5de-3b3aa3c89ed1.png" alt="image" data-proofer-ignore></p><p>즉, 자원을 공유하는 부분에서 스케줄러나 인터럽트를 통해 레지스터가 <strong>saved</strong>되거나 <strong>restored</strong>되면 문제가 발생할 확률이 생기는 것이다.</p><p>위는 쓰레드 2개를 나타낸것이지만, 실제 코드에서는 쓰레드 100개가 동시에 같은 자원을 할당받는다. 그렇기에 결과적으로 -98000같은 숫자가 나오는 것이다.</p><hr /><h2 id="-race-condition"><span class="mr-2">🔑 Race Condition</span><a href="#-race-condition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>여러 개의 쓰레드나 프로세스가 공유 자원을 할당받으려하고 할당받아서, 그 수행의 결과값이 매 번 달라 예상치 못한 결과가 나오는 경우.</p><hr /><h2 id="-해결법-critical-section-problem"><span class="mr-2">🔑 해결법 (Critical Section Problem)</span><a href="#-해결법-critical-section-problem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>어떤 코드영역이 각각의 프로세스나 쓰레드마다 같은 데이터를 갱신하거나 접근하는 영역을 Critical Section(임계영역)이라고 부른다.</p><p>이럴경우 race Condition이 발생할 수 있고, 이를 해결하기 위한 방법들이 <strong>Critical Section Problem</strong>이라고 한다.</p><p>이 문제를 풀기 위해서는 개념적으로 3가지 요구되는 것들이 있다.</p><ul><li>Mutual Exclusion(상호배제): 어떤 프로세스가 임계영역에서 작업을 수행중일 때는 다른 프로세스는 접근할 수 없다는 것을 보장.</ul><p>하지만 상호배제를 적용하면 <strong>deadlock</strong>과 <strong>starvation</strong>이라는 문제가 발생한다.</p><ul><li>Progress(avoid <strong>deadlock</strong>): 쓰레드가 자원에 접근할 수 있는 상태를 일컫는 말. 임계 영역에 쓰레드가 있는 경우 Progress가 있다고 할 수 있고, 임계 영역에 쓰레드가 없는 경우 Progress가 없다고 한다. 그래서 임계영역에 있는 쓰레드는 자원에 접근이 가능하지만, 임계영역에 없는 쓰레드는 자원에 접근이 불가능하다는 것. 그래서 임계영역에 들어갈 쓰레드를 결정해줘야한다.<li>Bounded waiting(avoid <strong>starvation</strong>): 기아를 방지하기 위해서 한 번 임계구역에 들어간 프로세스나 쓰레드는 다음번 임계구역에 들어갈 때 제한을 두어야 한다.</ul><p>이 3가지를 모두 만족하면 임계구역 문제를 해결하였다고 할 수 있지만, 현실적으로 3가지를 모두 만족하기란 쉽지가 않다.</p><p>이러한 임계영역에 동시접근을 해결하기 위해서는 공유자원에 접근 하였을 때 <strong>인터럽트</strong>자체를 방지하여 컨택스트 스위치가 발생하지 않도록 만들 수 있지만, 멀티프로세서 환경에서는 모든 코어에 대해 인터럽트를 막으면 효율성이 떨어지므로 사용하지 않는다.</p><ul><li>Mutex Locks<li>Semaphore<li>Monitor<li>Liveness</ul><p><code class="language-plaintext highlighter-rouge">Liveness</code>는 다른 방법의 단점을 극복하고 Mutual Exclusion + Progress까지 수행. 나머지는 Mutual Exclusion까지만</p><h3 id="-mutex-locks"><span class="mr-2">🔑 Mutex Locks</span><a href="#-mutex-locks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>mutex: <strong>mut</strong>ual <strong>ex</strong>clusion</ul><p>임계역역에 들어갈 때 Lock이라는 것을 걸고, 나올 때 Lock을 풀어서 상호배제를 보장하는 방법. 즉, 프로세스나 쓰레드는 <strong>Lock</strong>라는 것을 획득하고 임계영역에 들어가야한다. 단순한 방법</p><p>개념적으로 이런식으로 구현이 가능하다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">//locking = acquire</span>
<span class="n">lock</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="c1">// critical section of code goes here</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="c1">//unlocking = release</span>
    <span class="n">lock</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">try</span> <span class="o">{</span>
    <span class="n">lock</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
    <span class="n">account</span><span class="o">.</span><span class="na">withDraw</span><span class="o">(</span><span class="n">money</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
            <span class="s">"Thread %s - Task %d canceled.%n"</span><span class="o">,</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="n">money</span><span class="o">);</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
<span class="o">}</span><span class="k">finally</span> <span class="o">{</span>
    <span class="n">lock</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>결과</p><p><img data-src="https://user-images.githubusercontent.com/30401054/209431945-a918996c-ba0a-4cbe-82c6-ff79b068caa6.png" alt="image" data-proofer-ignore></p><ul><li><p>단점</p><li><p>Busy waiting: 내부적으로 다른프로세스들이 lock이 풀려있는지 while(true)를 통해 계속 질의하여 의미없이 CPU가 계속 돌아가고 있는 문제.</p></ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyClass</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">locked</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// busy waiting loop 다른 프로세스, 쓰레드는 계속 여기 걸려있음.</span>
    <span class="o">}</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">// critical section of code goes here</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><ul><li>Spinlock: 위의 Busy waiting이 생기면 while문 끝으로 갔다가 다시 올라가고 하는 형태가 마치 spin의 형태라서 지어진 이름. Busy waiting이 멀티 프로세스환경에서 마냥 나쁜게 아니다. 왜냐하면 context switch가 일어나지 않기에 그 시간을 절약할 수 있다는 것 즉, ready-Queue에서 대기했다가 가는것이 아니고 프로세스가 계속 Running상태에서 공유자원이 해제되면 들어갈 수 있기 때문이다.</ul><h3 id="-semaphores"><span class="mr-2">🔑 Semaphores</span><a href="#-semaphores" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="https://user-images.githubusercontent.com/30401054/209433925-7763adf7-f126-4837-b846-590126cd37eb.png" alt="image" data-proofer-ignore></p><blockquote><p>알고리즘 개념도</p></blockquote><p><img data-src="https://user-images.githubusercontent.com/30401054/209433897-d76b57a8-c9ea-4573-8a40-ae5a537a2065.png" alt="image" data-proofer-ignore></p><blockquote><p>전체 구성도</p></blockquote><p>mutex-lock 경우는 임계구역에 하나의 프로세스나 쓰레드만 접근이 가능했지만, 세마포어는 접근가능한 쓰레드나 프로세스의 개수를 정해놓으면 접근할 때마다 <code class="language-plaintext highlighter-rouge">count</code>변수를 빼고 임계구역을 벗어날때마다 <code class="language-plaintext highlighter-rouge">count</code>변수를 증가시켜 자원에 접근가능한 쓰레드 수를 제한할 수 있다. 그러다가 <code class="language-plaintext highlighter-rouge">count</code>변수가 0이 되면 모든 리소스가 할당된 것이므로 다른 쓰레드는 접근이 불가능하게 막는다.</p><p>count를 빼는 행위를 <strong>wait()</strong>한다고 하고, count를 더하는 행위를 <strong>signal()</strong>이라고 한다.(세마포어에서 사용하는 용어)</p><ul><li>Binary Semaphore</ul><p>자원에 접근 가능한 쓰레드 수를 0 ~ 1로 제한하는 것. mutex-lock처럼 동작한다.</p><ul><li>Counting Semaphore</ul><p>자원에 접근 가능한 쓰레드 수를 2이상으로 제한하는 것이다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/209434363-cd5ce6e3-735a-407d-b7f1-1a9526a60d24.png" alt="image" data-proofer-ignore></p><p>S1을 수행하는 프로세스를 P1, S2를 수행하는 프로세스를 P2라 하자. 그리고 count변수를 0으로 초기화되어있다고 한다.</p><p>만약 쓰레드간 순서를 제어하고 싶다면 위처럼 구현하면 된다.</p><p>P1이 자원을 반납하면 count가 1증가하여 사용할 수 있게 되는데, 이로인해서 P2는 S1이 끝날때까지 접근이 불가능한 것이다.</p><p>세마포어도 <u>busy waiting</u>의 문제가 있는데, 멀티프로세서 환경에서는 <u>spinlock</u>으로 사용해도 되지만, 그렇지 않은 경우 이를 해결해야한다.</p><p>그래서 세마포어를 통해 자원에 접근을 할 수 없다면 자기 자체를 중지하고 <u>waiting queue</u>로 보내고 다른 프로세스가 <strong>signal()</strong>을 호출하면 <u>waiting quque</u>에 있던 프로세스를 <u>ready queue</u>로 보내는 전략이 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Account</span><span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Semaphore</span> <span class="n">semaphoreForWithdraw</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">balance</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Account</span><span class="o">(</span><span class="kt">int</span> <span class="n">balance</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">balance</span> <span class="o">=</span> <span class="n">balance</span><span class="o">;</span>
        <span class="n">semaphoreForWithdraw</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Semaphore</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">withDraw</span><span class="o">(</span><span class="kt">int</span> <span class="n">money</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">balance</span> <span class="o">&gt;=</span> <span class="n">money</span><span class="o">){</span>
            <span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">();</span>
            <span class="n">semaphoreForWithdraw</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
            <span class="k">this</span><span class="o">.</span><span class="na">balance</span> <span class="o">-=</span> <span class="n">money</span><span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
                    <span class="s">"WithDraw Function Thread %s - Task %d finished.%n"</span><span class="o">,</span> <span class="n">thread</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">getBalance</span><span class="o">());</span>
            <span class="n">semaphoreForWithdraw</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getBalance</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">balance</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>출금하는 부분은 쓰레드 1개만 들어와야하므로 위의 세마포어를 이용해 동기화문제를 해결할 수 있다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/209435461-999859a8-7fc3-4994-a7e2-045ca2a7457b.png" alt="image" data-proofer-ignore></p><p>위의 결과에서 WithDraw ~ 출력부분을 보면 순차적으로 잘 빼고 있음을 볼 수 있다.</p><p>그리고 접근 가능한 쓰레드 수를 1이 아닌 2로 지정하면 동기화문제가 해결되지 않는것을 볼 수 있다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/209435770-ed20518a-ee80-454f-9d1d-ea987f2c0f4e.png" alt="image" data-proofer-ignore></p><p>결국 적절한 세마포어 수와, 내부적 알고리즘을 얼마나 Atomic하게 짰냐에 따라 다르다.</p><h3 id="-monitors"><span class="mr-2">🔑 Monitors</span><a href="#-monitors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>세마포어는 잘 쓰면 효율적이고 편리하게 동기화 문제를 해결할 수 있지만 가장 적절한 접근 가능한 쓰레드 수를 지정하는 일은 매우 어렵다.</p><p>그리고 세마포어는 <strong>timing error</strong>라는 문제가 발생할 수 있는데, 적절한 곳에 <code class="language-plaintext highlighter-rouge">wait()</code>나 <code class="language-plaintext highlighter-rouge">signal()</code>을 안 써주는 경우 코드를 짜다보니 <code class="language-plaintext highlighter-rouge">wait()</code>을 생략하거나 두 번 호출된 경우 등 예측할 수 없는 문제가 발생할 수 있는 문제다. 즉, 해당 함수를 호출하는 순서가 중요해진다는 것이다.</p><p>여기서 상대적으로 간단한 동기화 도구인 <u>monitor</u>가 등장했다.</p><h4 id="monitor-type"><span class="mr-2">monitor type</span><a href="#monitor-type" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>monitor type은 상호배제를 제공하는 일종의 데이터 타입이라고 생각하면 된다.</p><p>이 데이터 타입 안에 있는 구문들은 모두 동기화를 보장할 수 있도록 하는 것이다. Java에서는 <code class="language-plaintext highlighter-rouge">synchronized</code>키워드가 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">withDraw</span><span class="o">(</span><span class="kt">int</span> <span class="n">money</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">balance</span> <span class="o">&gt;=</span> <span class="n">money</span><span class="o">){</span>
            <span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">();</span>
            <span class="k">this</span><span class="o">.</span><span class="na">balance</span> <span class="o">-=</span> <span class="n">money</span><span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
                    <span class="s">"WithDraw Function Thread %s - Task %d finished.%n"</span><span class="o">,</span> <span class="n">thread</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">getBalance</span><span class="o">());</span>

        <span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">synchronized</code> 키워드만 추가해주면 해당 블럭들은 전부 임계구역이 된다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/209437330-8858180f-b0bd-4321-9c02-4f9c416e699b.png" alt="image" data-proofer-ignore></p><p>하나가 끝날 때까지 다른 스레드들은 접근을 못한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="o">(</span><span class="n">balance</span> <span class="o">&gt;=</span> <span class="n">money</span><span class="o">){</span>
    <span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">();</span>
    <span class="kd">synchronized</span> <span class="o">(</span><span class="nc">Account</span><span class="o">.</span><span class="na">class</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">balance</span> <span class="o">-=</span> <span class="n">money</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
            <span class="s">"WithDraw Function Thread %s - Task %d finished.%n"</span><span class="o">,</span> <span class="n">thread</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">getBalance</span><span class="o">());</span>

<span class="o">}</span>
</pre></table></code></div></div><p>이런식으로 block을 지정해서 동기화문제를 해결할 수도 있다.</p><p>mutexlock과의 차이점은 권한 제어 여부에 있다.</p><p>monitors는 스레드가 순차적으로 실행되기 위함의 목적이 있고, mutexlock은 스레드가 자원에 접근할 수 있는 권한을 제어하기 위함에 목적이 있다.</p><h2 id="정리"><span class="mr-2">🔑정리</span><a href="#정리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>동기화를 해결하기 위해 3가지 기법이 있다.</p><ul><li>mutex lock: 임계구역에 락이라는걸 걸어서 상호배제를 보장하는방법<li>Semaphores: 임계구역에 접근이 가능한 쓰레드 수를 제한해서 상호배제를 보장하는 방법<li>Monitors: 임계구역에 접근할 수 있는 쓰레드의 순서를 제어하는 방법.</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/interview/'>Interview</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/interview/" class="post-tag no-text-decoration" >interview</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Java,OS- 동시성 정리 - 민석강&amp;url=https://kkminseok.github.io/posts/2022-12-25TIL/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Java,OS- 동시성 정리 - 민석강&amp;u=https://kkminseok.github.io/posts/2022-12-25TIL/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://kkminseok.github.io/posts/2022-12-25TIL/&amp;text=Java,OS- 동시성 정리 - 민석강" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/2023-03-06-dnd/">DND 8기 활동 후기</a><li><a href="/posts/2024-03-31-fastapi/">fastapi Swagger Response 분리하기</a><li><a href="/posts/2023-05-19-think01/">5월19일시점 개발하면서 고민한 것들 + 도커관련 이슈</a><li><a href="/posts/2023-05-02-Modern-Java-In-action/">2번 읽는 Modern Java In Action - Chapter06 스트림으로 데이터 수집</a><li><a href="/posts/2023-03-18-Modern-Java-In-Action/">2번 읽는 Modern Java In Action - Chapter01 기초</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/algorithmstudy/">AlgorithmStudy</a> <a class="post-tag" href="/tags/top100like/">Top100Like</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/fastapi/">FastAPI</a> <a class="post-tag" href="/tags/economy/">Economy</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/top100interview/">Top100Interview</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/20221207InterviewBook01/"><div class="card-body"> <em class="timeago small" data-ts="1670346120" > 2022-12-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 1장 - 사용자 수에 따른 규모 확장성</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 원준이라는 친구가 나 공부 열심히하라고 책을 선물해줬다. 읽어보도록 했다. 1장은 한 명의 사용자를 지원하는 시스템에서 시작한다. ✏️ 단일 서버 웹브라우저, 웹 서버, DNS가 있을때 사용자의 요청 (웹 브라우저에서 요청을 보냄)이 어떻게 처리되는지를 알...</p></div></div></a></div><div class="card"> <a href="/posts/20221208InterviewBook02/"><div class="card-body"> <em class="timeago small" data-ts="1670432520" > 2022-12-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 2장 - 개략적인 규모 추정</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 이 장은 시스템 용량이나 성능 요구사항을 개략적으로 측정하는 방법에 대해 다룬다. 개략적 규모 추정을 효과적으로 필요한 기본기에 능숙해야 한다. 특히, 2의 제곱수나 응답지연(latency) 값, 그리고 가용성에 관계된 수치들을 기본적으로 잘 이해하고 있어야 한다고...</p></div></div></a></div><div class="card"> <a href="/posts/2022-12-09-InterviewBoo03/"><div class="card-body"> <em class="timeago small" data-ts="1670515320" > 2022-12-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 3장 - 시스템 설계 면접 공략법</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 시스템 설계 면접은 두 명의 동료가 모호한 문제를 풀기 위해 협력하여 해결책을 찾아가는 과정이다. 때문에 정답도 없고 결과도 없다. 설계과정에서 내린 결정에 대해 방어하는 능력을 보는 과정이고, 면접관의 피드백을 건설적인 방향으로 처리할 자질이 있음을 보는 면접이다....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/2022-12-16-interViewBook08/" class="btn btn-outline-primary" prompt="Older"><p>가상 면접 사례로 배우는 대규모 시스템 설계 기초 8장 - URL 단축기 설계</p></a> <a href="/posts/2022-12-27-realworld-trouble/" class="btn btn-outline-primary" prompt="Newer"><p>real-world프로젝트 이슈 - @AuthenticationPrincipal 테스트코드 작성하기</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "kkminseok/kkminseok.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkzNDUwNzI2OTM=", "data-category": "Announcements", "data-category-id": "DIC_kwDOFJFkNc4CO5-J", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/none">kang minseok</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/algorithmstudy/">AlgorithmStudy</a> <a class="post-tag" href="/tags/top100like/">Top100Like</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/fastapi/">FastAPI</a> <a class="post-tag" href="/tags/economy/">Economy</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/top100interview/">Top100Interview</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KMXXJ0D586"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KMXXJ0D586'); }); </script>
