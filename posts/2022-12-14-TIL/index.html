<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Process 정리" /><meta name="author" content="minseok" /><meta property="og:locale" content="ko" /><meta name="description" content="오타, 지적 환영입니다." /><meta property="og:description" content="오타, 지적 환영입니다." /><link rel="canonical" href="https://kkminseok.github.io/posts/2022-12-14-TIL/" /><meta property="og:url" content="https://kkminseok.github.io/posts/2022-12-14-TIL/" /><meta property="og:site_name" content="민석강" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-14T02:02:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Process 정리" /><meta name="twitter:site" content="@none" /><meta name="twitter:creator" content="@minseok" /><meta name="google-site-verification" content="_icgy_j24DLYroQvKYTiffcqemP7ldWCxmrM2cGtYck" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"minseok"},"dateModified":"2023-01-06T02:16:58+09:00","datePublished":"2022-12-14T02:02:00+09:00","description":"오타, 지적 환영입니다.","headline":"Process 정리","mainEntityOfPage":{"@type":"WebPage","@id":"https://kkminseok.github.io/posts/2022-12-14-TIL/"},"url":"https://kkminseok.github.io/posts/2022-12-14-TIL/"}</script><title>Process 정리 | 민석강</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="민석강"><meta name="application-name" content="민석강"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/sample/logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">민석강</a></div><div class="site-subtitle font-italic">3년차 개발자. 40살에 100억벌고 은퇴</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/kkminseok" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/none" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['minseok19950727','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Process 정리</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Process 정리</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/kkminseok">minseok</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1670950920" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-12-14 </em> </span> <span> Updated <em class="timeago" data-ts="1672939018" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-01-06 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3023 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><blockquote class="prompt-info"><div><p>오타, 지적 환영입니다.</p></div></blockquote><blockquote class="prompt-tip"><div><p>✏️<a href="https://github.com/KHU-Dasom/jinja-study">CS스터디 저장소</a></p></div></blockquote><h1 id="프로세스process">프로세스(Process)</h1><p>쉽게 말하면 <strong>실행중인 프로그램</strong>이다.</p><p>디스크에 있는 프로그램이 메모리에 로드되면 프로세스가 된다.</p><p>여기서 말하는 프로그램이란 <code class="language-plaintext highlighter-rouge">.exe</code>파일 같이 아직 실행되지 않은 명령어 집합체를 말한다.</p><h2 id="1-프로세스-문맥process-context"><span class="mr-2">1. 프로세스 문맥(Process Context)</span><a href="#1-프로세스-문맥process-context" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>여러 프로세스가 타이머 인터럽트에 의해 짧은 시간동안 CPU를 점유하며 서로 제어권을 넘겨주는 시분할 시스템 환경에 의해 나타남.<li>서로 제어권을 넘길때 어디까지 명령을 수행했는지, 상태에 대한 정보를 나타낼 필요가 있었음.</ul><p><strong>프로세스가 어떤 상태에서 수행되고 있는지 정확히 규명하기 위해 필요한 정보들.</strong></p><p>프로세스 문맥은 <strong>하드웨어 문맥, 프로세스의 주소공간, 커널상의 문맥</strong>으로 나뉨.</p><ul><li>하드웨어 문맥: PC(Program Counter)와 각종 레지스터에 저장하고 있는 값들.</ul><blockquote><p>Program Counter는 다음에 실행될 명령어의 주소를 가지고 있는 레지스터. 인텔에서는 IP(Instruction Pointer)로도 불림.</p></blockquote><ul><li>프로세스 주소공간: <strong>코드, 데이터, 스택, 힙</strong>으로 구성된 프로세스만의 독자적 주소 공간.</ul><p><img data-src="https://user-images.githubusercontent.com/30401054/205493183-1aed92d1-15f9-4e13-9c0f-8e6976699ab5.png" alt="image" data-proofer-ignore></p><p>코드는 프로그램의 코드가, 데이터는 전역변수 같은 데이터가, 스택에는 함수나 지역변수가 저장되어 있다.</p><ul><li>커널상의 문맥: PCB(Process Control Block), Kernel Stack(커널상의 주소)를 말한다.</ul><p><img data-src="https://user-images.githubusercontent.com/30401054/205495276-7999fb79-5257-4c06-a234-04747889146f.png" alt="image" data-proofer-ignore></p><p>PCB는 밑에서 설명, Kernel Stack이란 간단하게 프로세스 자체에서 처리할 수 없는것들은 운영체제 부탁하는데 이를 <strong>시스템 콜</strong>이라고 부른다. 시스템 콜이 발생하면 PC는 커널의 Code를 가리키고 커널의 함수를 호출한다. 이때 각 프로세스마다 호출하는 Code를 관리하기 위해서 Kernel Stack을 갖게 됨. 따라서 해당 프로세스의 커널 스택의 값이 뭔지 필요하게 됨.</p><h2 id="2-프로세스의-상태"><span class="mr-2">2. 프로세스의 상태</span><a href="#2-프로세스의-상태" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>PCB를 알기 전에 프로세스 상태에 대해 알고 있어야한다.</p><h3 id="five-state-process-model"><span class="mr-2">Five-State Process Model</span><a href="#five-state-process-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>보통 우리는 이 모델을 가지고 설명을 많이한다.</p><p>시분할 시스템 환경에서 프로세스의 상태는 <strong>New, Ready, Running, Waiting, Terminated</strong>로 구분이 가능하다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205495843-8cdbfe9f-67f2-4d11-83cb-5bd48e61cb29.png" alt="image" data-proofer-ignore></p><ul><li>New: 프로세스가 처음 생성된 단계, 메모리 할당 및 PCB와 스택 메모리 할당 및 초기화 등의 작업.<li>Ready: 프로세스가 CPU에 할당되기를 기다리는 상태.<li>Running: 프로세스가 할당되어 CPU를 잡고 명령을 수행중인 상태<li>Waiting: 프로세스가 어떠한 이벤트가 발생하기를 기다리는 상태<li>Terminated: 프로세스가 실행을 마치고 완전히 제거되진 않은 상태.</ul><h3 id="state-transitions"><span class="mr-2">State Transitions</span><a href="#state-transitions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>Dispatcher란 OS 프로그램의 일부로, 실행중인 프로그램을 중단하고 다른 프로그램을 실행시키도록 하는 프로그램이다.</p></blockquote><ul><li>New -&gt; Ready</ul><p>OS가 Ready 단계로 넘어가길 허락(Admit)해야 넘어갈 수 있다.</p><p>이러한 이유로 메모리 자원 문제 및 CPU 문제가 있기 때문이다.</p><ul><li>Ready -&gt; Running</ul><p>Dispatcher가 대기하고 있는 프로그램 중 적절한 프로그램을 골라 Running 상태로 옮김.</p><ul><li>Running -&gt; terminated</ul><p>OS는 프로그램이 종료하게 되면 exit상태를 거쳐 terminated로 옮김.</p><ul><li>Running -&gt; Ready</ul><p>프로그램의 할당 시간이 길어지면 timeout이 걸려(interrupt) Ready상태로 돌아간다.</p><ul><li>Running -&gt; Blocked</ul><p>프로그램 실행중 I/O Request, 시스템콜 등 작업을 요청하면 Blocked상태로 변경하여 대기한다.</p><ul><li>Blocked -&gt; Ready</ul><p>기다리던 이벤트가 발생하면 <strong>Running</strong>이 아닌 <strong>Ready</strong>상태로 간다.</p><p>중기 스케줄러로 인해 Seven-State Process Model이라는것도 생겨났으니 참고하면 된다.</p><h2 id="3-pcbprocess-control-block"><span class="mr-2">3. PCB(Process Control Block)</span><a href="#3-pcbprocess-control-block" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="https://user-images.githubusercontent.com/30401054/205495631-e630a30a-f2c0-4daf-a0a6-6f9a084779c3.png" alt="image" data-proofer-ignore></p><p>커널 Data영역에 있는 프로세스에 관한 정보들</p><ul><li>OS가 관리하는 정보: (1) 및 스케줄링 및 우선순위에 대한 정보를 가지고 있다.</ul><p>Pointer: 프로세스를 큐에서 관리하기에 이를 나타내기 위한 포인터 Process state: 위에서 말한 Ready, Running 등 프로세스 상태 Process number(PID): 프로세스를 구별하기 위한 숫자.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205497214-8a1ece70-d005-4a69-80fc-1ec03ccffa24.png" alt="image" data-proofer-ignore></p><p>PCB들은 메모리에 존재하고 상태에 따라 Ready Queue, Event Queue에서 관리 된다.</p><details> <summary> Ready Queue </summary> Ready 상태에 있는 프로세스만 모아둔 큐를 말한다. - **Scheduler**가 Ready큐에서 최우선순위 프로세스를 선택. - 선택된 프로세스를 **Dispatch**해서 CPU가 실행한다.(Running) </details> <details> <summary> Blocked(Waiting or Event) Queue - 대기큐 </summary> Blocked상태에 있는 프로세스만 모아둔 큐 - 각각의 `Device driver`에 존재하는 큐 - 키보드, 디스크, 네트워크, 세마포어, 등에 대기큐가 존재한다. - 예를 들어 I/O함수 등을 호출하면 Blocked 상태가 되며 PCB를 해당 장치의 대기큐로 이동시킴. - 이벤트가 발생하면 Device driver내의 함수는 대기큐에서 해당 PCB를 찾고 대기큐에서 제거 후 Ready Queue로 넘김.(Ready) </details><ul><li>CPU 수행 관련 하드웨어 값: (2)에 해당. 해당 프로세스가 어떤 값을 가지고 있었는지에 대한 정보</ul><p>ProgramCounter: 다음에 실행될 명령어의 위치를 가리키는 레지스터 Registers: 프로세스 실행 중 사용된 레즈스터 값들 (Accumulator, Index register…)</p><ul><li>메모리 관련: (3)에 해당. Code, Data, Stack의 위치 정보. 프로세스가 물리적으로 어디에 있는지 나타내는 위치정보.<li>파일 관련: (4)에 해당. 어떤 파일을 열어놨는지 등에 대한 정보</ul><p><strong>참고로 Blocked에 있는 프로세스를 찾을때 포트번호로 구별하여 PCB를 찾는다.</strong></p><h2 id="4-context-switch"><span class="mr-2">4. Context Switch</span><a href="#4-context-switch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="https://user-images.githubusercontent.com/30401054/205498368-14bf6f58-30f9-4b07-add4-1d7baa680bb5.png" alt="image" data-proofer-ignore></p><p><strong>멀티 프로세스 환경에서 프로세스가 실행되다가 인터럽트가 발생해서 CPU를 한 프로세스에서 다른 프로세스로 넘겨주는 과정</strong></p><p>운영체제는 CPU를 내어주는 A프로세스의 상태를 A프로세스의 PCB에 저장하고, CPU를 새롭게 얻는 B프로세스의 상태를 B프로세스의 PCB에서 읽어온다. CPU입장에서는 Context는 PCB이고, 이가 바뀌는것이 <strong>Context Switch</strong>다. 이는 OS 스케줄러에서 수행한다.</p><p>인터럽트나 시스템콜이 발생한다해서 반드시 <u>Context Switch가 발생하는것은 아니다.</u></p><p><img data-src="https://user-images.githubusercontent.com/30401054/205498888-c30c9d2f-a4c6-4a3d-9e6c-69c42d51aa10.png" alt="image" data-proofer-ignore></p><ul><li>Context Switch가 발생하지 않는 경우</ul><p>프로세스A -&gt; interrupt or system call -&gt; kernelMode -&gt; 프로세스A : Context Switch 없음.</p><ul><li>Context Switch가 발생하는 경우</ul><p>프로세스A -&gt; interrupt or I/O system call -&gt; kernelMode -&gt; <strong>Context Switch</strong> -&gt; 프로세스B</p><blockquote><p>Context Switch시 Cache memory flush라는 프로세스가 바뀔때 Cache를 초기화 시켜 오버헤드가 큼. 단점으로 캐시 히트가 줄어들고 초반 프로세스 작업 속도가 느려질 수 있다.</p></blockquote><blockquote><p>또한 Context Switch을 하는동안 CPU는 아무일을 하지 않는 시간이 발생하는데 이를 오버헤드라고 부름.</p></blockquote><h2 id="5-process-management"><span class="mr-2">5. Process Management</span><a href="#5-process-management" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>시스템이 부팅된 후 최초 프로세스는 운영체제가 직접 생성, 그 이후로는 프로세스를 복제하여 생성하게 된다. 프로세스를 복제한 프로세스를 <strong>부모 프로세스</strong> 새롭게 생성된 프로세스를 <strong>자식 프로세스</strong>라고 한다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205913724-d288f657-8bc9-4732-85b1-9e6359c5497e.png" alt="image" data-proofer-ignore></p><p>각 프로세스는 <strong>PID</strong>로 구별되고, 자원은 운영체제로부터 할당받거나 부모와 공유한다.</p><h3 id="fork"><span class="mr-2">fork()</span><a href="#fork" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><code class="language-plaintext highlighter-rouge">fork()</code>라는 시스템콜은 새로운 프로세스를 생성한다.</p><p><code class="language-plaintext highlighter-rouge">fork()</code>를 통해 자식은 부모의 pid를 제외하고 그대로 복사한다. <code class="language-plaintext highlighter-rouge">fork()</code>함수의 리턴값은 부모는 0보다 큰 수, 자식은 0을 갖는다.</p><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">ssu_charatatime</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">ptr</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">print_char</span><span class="p">;</span>

    <span class="n">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">str</span><span class="p">;</span> <span class="p">(</span><span class="n">print_char</span> <span class="o">=</span> <span class="o">*</span><span class="n">ptr</span><span class="o">++</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;)</span> <span class="p">{</span>
        <span class="n">putc</span><span class="p">(</span><span class="n">print_char</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
        <span class="n">usleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[],</span> <span class="kt">char</span> <span class="o">*</span><span class="n">envpp</span><span class="p">[])</span> <span class="p">{</span>
    <span class="n">pid_t</span> <span class="n">pid</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">((</span><span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ssu_charatatime</span><span class="p">(</span><span class="s">"output from child</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ssu_charatatime</span><span class="p">(</span><span class="s">"output from parent</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>결과</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205925977-988e3eae-d7f9-4ece-905a-9163ff7d3062.png" alt="image" data-proofer-ignore></p><h2 id="6-process-cooperating"><span class="mr-2">6. Process Cooperating</span><a href="#6-process-cooperating" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>프로세스는 동작 방식에 따라 2가지 방식으로 나뉜다. 먼저 <strong>독립적 프로세스(Independent Process)</strong>는 각자 주소 공간을 가지면서 수행되고 원칙적으로는 하나의 프로세스가 다른 프로세스의 수행에 영향을 미치지는 않는다.</p><p><strong>협력 프로세스(Cooperating Process)</strong>는 <strong>IPC(InterProcess Communication)</strong>이라는 프로세스 협력 메커니즘을 통해 하나의 프로세스가 다른 프로세스 수행에 영향을 미칠 수 있다.</p><p>IPC에는 크게 두 모델이 있다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205932307-09566b22-34f3-4f98-9f60-28d2a2938622.png" alt="image" data-proofer-ignore></p><h3 id="공유-메모리shared-memory"><span class="mr-2">공유 메모리(Shared Memory)</span><a href="#공유-메모리shared-memory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>서로 다픈 프로세스 간에 일부 주소 공간을 공유.</p><p>위의 그림처럼 같은 공간을 사용하므로 일관성 문제가 생길 수 있다.</p><p>장점으로는 <strong>커널</strong>을 거치지 않기에 빠르다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205940578-3832e246-9379-49ef-8d10-09b75a57a0bf.png" alt="image" data-proofer-ignore></p><p>커널은 또 정리하는 편이 좋지만 여기서는 간단하게 <code class="language-plaintext highlighter-rouge">fork()</code>라는 함수를 실행하면 OS자체에서 내부적으로 이 코드를 실행하기 위해 로직을 돌텐데 이때 도는 로직들은 커널공간에서 돈다고 생각하면 된다.</p><h3 id="메시지-패싱message-passing"><span class="mr-2">메시지 패싱(Message Passing)</span><a href="#메시지-패싱message-passing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>커널</strong>을 통해 메시지를 주고 받는다. Context Switch가 발생하기에 속도가 느리지만, 커널이 기본 기능을 제공하기에 구현이 쉽고, 일관성 문제를 해결하기 쉽다.</p><ul><li>기본적으로 Send/Receive 동작을 통해 교환한다.</ul><p>1) Direct Communication</p><p>통신하는 프로세스의 이름을 명시적으로 표시해야한다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205941591-553c7b4e-ea5a-4aea-9327-52bfe8da0556.png" alt="image" data-proofer-ignore></p><p>때문에 서로 이름만 알면 된다. 이는 단점이 될 수도 있는데, 만약 프로세스의 이름을 변경해야한다면 연결되어 있는 모든 Send/Receive 프로세스를 바꿔줘야한다.</p><p>2) Indirect Dommunication</p><p><strong>mailbox</strong>를 통해 메시지를 전달한다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205941977-4c02b54b-482d-4fbe-9b82-c2485d8d37f3.png" alt="image" data-proofer-ignore></p><p>이 mailbox는 고유의 ID를 가지고 있고, 이 ID를 통해 연결된 프로세스들이 통신을 할 수 있다.</p><ul><li>Blocking send : 수신자(프로세스 or mailbox)가 메시지를 받을 때까지 발신자는 block 된다.<li>Non-blocking send : 발신자가 메시지를 보내고 작업을 계속한다.<li>Blocking receive : 수신자가 메시지를 받을 때까지 block 된다.<li>Non-blocking receive : 수신자는 유효한 메시지 또는 null 메시지를 받는다.</ul><p>프로세스끼리 통신할 때 <strong>파이프(Pipe)</strong>방식으로도 통신한다. 이는 단방향만 가능해서 양방향으로 통신하려면 두 개의 파이프가 필요하다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/205942742-ef87e0c7-69e1-41df-ab00-4cbdea0ad43c.png" alt="image" data-proofer-ignore></p><p>이 파이프는 <strong>Anonymous 파이프와 named 파이프</strong>로 구분되는데 전자는 부모-자식 또는 공통의 부모를 갖는 프로세스끼리 통신이 가능하다. 후자는 그런 관계 없이 사용할 수 있다.</p><h2 id="reference"><span class="mr-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="https://velog.io/@zooneon/OS-Process-State#-dispatcher">https://velog.io/@zooneon/OS-Process-State#-dispatcher</a> 프로세스 상태모델<li><a href="https://ws-pace.tistory.com/20">https://ws-pace.tistory.com/20</a> PCB 등<li><a href="https://rebro.kr/172">https://rebro.kr/172</a> Context Switch<li><a href="https://bubble-dev.tistory.com/entry/CC-fork2">https://bubble-dev.tistory.com/entry/CC-fork2</a> fork()</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/interview/'>Interview</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/interview/" class="post-tag no-text-decoration" >interview</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Process 정리 - 민석강&amp;url=https://kkminseok.github.io/posts/2022-12-14-TIL/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Process 정리 - 민석강&amp;u=https://kkminseok.github.io/posts/2022-12-14-TIL/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://kkminseok.github.io/posts/2022-12-14-TIL/&amp;text=Process 정리 - 민석강" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/2023-03-06-dnd/">DND 8기 활동 후기</a><li><a href="/posts/2024-03-31-fastapi/">fastapi Swagger Response 분리하기</a><li><a href="/posts/2023-05-19-think01/">5월19일시점 개발하면서 고민한 것들 + 도커관련 이슈</a><li><a href="/posts/2023-05-02-Modern-Java-In-action/">2번 읽는 Modern Java In Action - Chapter06 스트림으로 데이터 수집</a><li><a href="/posts/2023-03-18-Modern-Java-In-Action/">2번 읽는 Modern Java In Action - Chapter01 기초</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/algorithmstudy/">AlgorithmStudy</a> <a class="post-tag" href="/tags/top100like/">Top100Like</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/fastapi/">FastAPI</a> <a class="post-tag" href="/tags/economy/">Economy</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/top100interview/">Top100Interview</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/20221207InterviewBook01/"><div class="card-body"> <em class="timeago small" data-ts="1670346120" > 2022-12-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 1장 - 사용자 수에 따른 규모 확장성</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 원준이라는 친구가 나 공부 열심히하라고 책을 선물해줬다. 읽어보도록 했다. 1장은 한 명의 사용자를 지원하는 시스템에서 시작한다. ✏️ 단일 서버 웹브라우저, 웹 서버, DNS가 있을때 사용자의 요청 (웹 브라우저에서 요청을 보냄)이 어떻게 처리되는지를 알...</p></div></div></a></div><div class="card"> <a href="/posts/20221208InterviewBook02/"><div class="card-body"> <em class="timeago small" data-ts="1670432520" > 2022-12-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 2장 - 개략적인 규모 추정</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 이 장은 시스템 용량이나 성능 요구사항을 개략적으로 측정하는 방법에 대해 다룬다. 개략적 규모 추정을 효과적으로 필요한 기본기에 능숙해야 한다. 특히, 2의 제곱수나 응답지연(latency) 값, 그리고 가용성에 관계된 수치들을 기본적으로 잘 이해하고 있어야 한다고...</p></div></div></a></div><div class="card"> <a href="/posts/2022-12-09-InterviewBoo03/"><div class="card-body"> <em class="timeago small" data-ts="1670515320" > 2022-12-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 3장 - 시스템 설계 면접 공략법</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 시스템 설계 면접은 두 명의 동료가 모호한 문제를 풀기 위해 협력하여 해결책을 찾아가는 과정이다. 때문에 정답도 없고 결과도 없다. 설계과정에서 내린 결정에 대해 방어하는 능력을 보는 과정이고, 면접관의 피드백을 건설적인 방향으로 처리할 자질이 있음을 보는 면접이다....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/2022-12-14-interviewBook06/" class="btn btn-outline-primary" prompt="Older"><p>가상 면접 사례로 배우는 대규모 시스템 설계 기초 6장 - 키-값 저장소 설계</p></a> <a href="/posts/2022-12-14-JavaVersion12/" class="btn btn-outline-primary" prompt="Newer"><p>Java 12버전은 뭐가 달라졌나</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "kkminseok/kkminseok.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkzNDUwNzI2OTM=", "data-category": "Announcements", "data-category-id": "DIC_kwDOFJFkNc4CO5-J", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/none">kang minseok</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/algorithmstudy/">AlgorithmStudy</a> <a class="post-tag" href="/tags/top100like/">Top100Like</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/fastapi/">FastAPI</a> <a class="post-tag" href="/tags/economy/">Economy</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/top100interview/">Top100Interview</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KMXXJ0D586"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KMXXJ0D586'); }); </script>
