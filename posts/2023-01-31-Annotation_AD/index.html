<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Java Lombok @Get 직접 구현해보면서 프로세서 분석하기." /><meta name="author" content="minseok" /><meta property="og:locale" content="ko" /><meta name="description" content="롬복을 만들어보면서 어노테이션이 어떻게? 동작하는지 알아보자." /><meta property="og:description" content="롬복을 만들어보면서 어노테이션이 어떻게? 동작하는지 알아보자." /><link rel="canonical" href="https://kkminseok.github.io/posts/2023-01-31-Annotation_AD/" /><meta property="og:url" content="https://kkminseok.github.io/posts/2023-01-31-Annotation_AD/" /><meta property="og:site_name" content="민석강" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-31T01:02:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Java Lombok @Get 직접 구현해보면서 프로세서 분석하기." /><meta name="twitter:site" content="@none" /><meta name="twitter:creator" content="@minseok" /><meta name="google-site-verification" content="_icgy_j24DLYroQvKYTiffcqemP7ldWCxmrM2cGtYck" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"minseok"},"dateModified":"2023-02-01T02:07:36+09:00","datePublished":"2023-01-31T01:02:00+09:00","description":"롬복을 만들어보면서 어노테이션이 어떻게? 동작하는지 알아보자.","headline":"Java Lombok @Get 직접 구현해보면서 프로세서 분석하기.","mainEntityOfPage":{"@type":"WebPage","@id":"https://kkminseok.github.io/posts/2023-01-31-Annotation_AD/"},"url":"https://kkminseok.github.io/posts/2023-01-31-Annotation_AD/"}</script><title>Java Lombok @Get 직접 구현해보면서 프로세서 분석하기. | 민석강</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="민석강"><meta name="application-name" content="민석강"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/sample/logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">민석강</a></div><div class="site-subtitle font-italic">3년차 개발자. 40살에 100억벌고 은퇴</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/kkminseok" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/none" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['minseok19950727','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Java Lombok @Get 직접 구현해보면서 프로세서 분석하기.</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Java Lombok @Get 직접 구현해보면서 프로세서 분석하기.</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/kkminseok">minseok</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1675094520" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-01-31 </em> </span> <span> Updated <em class="timeago" data-ts="1675184856" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-02-01 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3843 words"> <em>21 min</em> read</span></div></div></div><div class="post-content"><h1 id="롬복을-만들어보면서-어노테이션이-어떻게-동작하는지-알아보자">롬복을 만들어보면서 어노테이션이 어떻게? 동작하는지 알아보자.</h1><p>참고자료: <a href="https://catch-me-java.tistory.com/49">https://catch-me-java.tistory.com/49</a> =&gt; 원론적인 부분</p><p><a href="https://catsbi.oopy.io/78cee801-bb9c-44af-ad1f-dffc5a541101">https://catsbi.oopy.io/78cee801-bb9c-44af-ad1f-dffc5a541101</a></p><blockquote><p>다른 API를 이용하여 아예 클래스를 컴파일단계에서 새로 만드는 방법을 제시<br /> 기존에 있는것을 수정이 불가능함</p></blockquote><h2 id="-환경구성"><span class="mr-2">🔅 환경구성</span><a href="#-환경구성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>Intellij: 2021.2.1<li>Language: Java 8<li>ProjectName: customLombok<li>구현내용: @Get(getter)</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>2.7.8<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;relativePath/&gt;</span> <span class="c">&lt;!-- lookup parent from repository --&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>me.kms<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>customLombok<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;name&gt;</span>customLombok<span class="nt">&lt;/name&gt;</span>
	<span class="nt">&lt;description&gt;</span>customLombok<span class="nt">&lt;/description&gt;</span>
	<span class="nt">&lt;properties&gt;</span>
		<span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
		<span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;maven.compiler.source&gt;</span>1.8<span class="nt">&lt;/maven.compiler.source&gt;</span>
        <span class="nt">&lt;maven.compiler.target&gt;</span>1.8<span class="nt">&lt;/maven.compiler.target&gt;</span>
		<span class="nt">&lt;auto-service.version&gt;</span>1.0-rc4<span class="nt">&lt;/auto-service.version&gt;</span>
	<span class="nt">&lt;/properties&gt;</span>
	<span class="nt">&lt;dependencies&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>

		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>

		<span class="nt">&lt;dependency&gt;</span>
          <span class="nt">&lt;groupId&gt;</span>com.google.auto.service<span class="nt">&lt;/groupId&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>auto-service<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>${auto-service.version}<span class="nt">&lt;/version&gt;</span>
          <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
          <span class="nt">&lt;groupId&gt;</span>com.github.olivergondza<span class="nt">&lt;/groupId&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-jdk-tools-wrapper<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>0.1<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;/dependencies&gt;</span>

	<span class="nt">&lt;build&gt;</span>
		<span class="nt">&lt;plugins&gt;</span>
			<span class="nt">&lt;plugin&gt;</span>
				<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
				<span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;/plugin&gt;</span>
		<span class="nt">&lt;/plugins&gt;</span>
	<span class="nt">&lt;/build&gt;</span>

<span class="nt">&lt;/project&gt;</span>

</pre></table></code></div></div><ul><li>스프링 부트 3버전은 Java17버전부터 지원하므로 그 아래 단계를 선택</ul><h2 id="1-annotation-get"><span class="mr-2">🔅1. Annotation Get</span><a href="#1-annotation-get" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="11-get-코드"><span class="mr-2">1.1 @Get 코드</span><a href="#11-get-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">mylombok</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.*</span><span class="o">;</span>
<span class="cm">/**
 * @Target의 ElementType.TYPE에 의해 클래스/인터페이스/열거/레코드 타입에 어노테이션을 붙일 수 있게 되었다.
 * @Get의 기본방식은 컴파일 이후에는 쓰이지 않게 구성되어 있으므로, RentetionPolicy를 SOURCE로 해둬서 컴파일 이전까지 쓰이게 한다.
 *
 * @author kms
 * */</span>
<span class="nd">@Documented</span>
<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">SOURCE</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Get</span> <span class="o">{</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="12-get-어노테이션-프로세스"><span class="mr-2">1.2 Get 어노테이션 프로세스</span><a href="#12-get-어노테이션-프로세스" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nd">@SupportedAnnotationTypes</span><span class="o">(</span><span class="s">"me.kms.anno.Get"</span><span class="o">)</span>
<span class="nd">@AutoService</span><span class="o">(</span><span class="nc">Processor</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GetProcessor</span> <span class="kd">extends</span> <span class="nc">AbstractProcessor</span> <span class="o">{</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">SourceVersion</span> <span class="nf">getSupportedSourceVersion</span><span class="o">(){</span>
        <span class="k">return</span> <span class="nc">SourceVersion</span><span class="o">.</span><span class="na">RELEASE_8</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">TypeElement</span><span class="o">&gt;</span> <span class="n">annotations</span><span class="o">,</span> <span class="nc">RoundEnvironment</span> <span class="n">roundEnv</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//logic</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h4 id="supportedannotationtypes"><span class="mr-2"><strong>@SupportedAnnotationTypes</strong></span><a href="#supportedannotationtypes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>인자로 들어온 값의 경로를 찾고 해당 어노테이션의 값을 사용하여, 어떠한 <strong>처리</strong>를 할 수 있게 도와준다.<ul><li>이는 <code class="language-plaintext highlighter-rouge">Processor</code>라는 인터페이스에 정의된 <code class="language-plaintext highlighter-rouge">getSupportedAnnotationTypes</code>라는 메서드를 통해 인자로 들어온 어노테이션의 이름을 반환하여 작업을 할 수 있게 도와준다.<li>우리가 extends한 <code class="language-plaintext highlighter-rouge">AbstractProcessor</code> 클래스는 위의 <code class="language-plaintext highlighter-rouge">Processor</code>를 구현한 구현체이며, 우리가 필요한것들만 오버라이드 해서 사용할 것이다.</ul><li><strong>Annotation Processor</strong>를 지원하는 어노테이션 인터페이스를 나타내는 어노테이션임을 뜻한다.<ul><li>Annotation Processor란 어노테이션을 처리하는 일종의 프로그램이다.</ul><li>이를통해 Annotation Processor는 특정 어노테이션 인터페이스를 사용하는 클래스를 검색하여 처리할 수 있게 된다.</ul><p>즉, 코드에서는 <code class="language-plaintext highlighter-rouge">mylombok</code>패키지에 있는 <code class="language-plaintext highlighter-rouge">Get</code>어노테이션을 처리하도록 도와주는 소스이다.</p><h4 id="supportedsourceversionsourceversionrelease_8"><span class="mr-2"><strong>@SupportedSourceVersion(SourceVersion.RELEASE_8)</strong></span><a href="#supportedsourceversionsourceversionrelease_8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>밑의 <code class="language-plaintext highlighter-rouge">getSupportedSourceVersion()</code>로 대체가 가능하다.<li>특정 버전에서의 자바에서만 사용가능하도록 지정할 수가 있다. 위의 예시는 자바8버전에서만 사용가능하다고 명시한 예시다.<ul><li>여러 버전을 지정하고 싶다면 <code class="language-plaintext highlighter-rouge">@SupportedSourceVersion(value = {RELEASE_8,RELEASE_11,RELEASE_14})</code>이런식으로 사용이 가능하다.</ul></ul><h4 id="autoserviceprocessorclass"><span class="mr-2"><strong>@AutoService(Processor.class)</strong></span><a href="#autoserviceprocessorclass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>원래는 <code class="language-plaintext highlighter-rouge">resources / META-INF /javax.annotation.processing.Processor</code>파일에 다음과 같은 내용을 써주고 컴파일 해야한다.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>me.kms.anno.GetProcessor
</pre></table></code></div></div><p>이렇게 작성하고 <code class="language-plaintext highlighter-rouge">mvn clean install</code>을 수행하면 에러가 발생하는데, 메이븐이 소스 컴파일 하는 시점에 프로세서가 동작하려고 하니, 아직 컴파일 되지 않은 소스를 읽으려 하면서 에러가 나오는 것이다.</p><p>그래서 위의 문구를 주석처리하고, 다시 컴파일 하면 된다.</p><p>그리고 다시 주석을 풀고, <code class="language-plaintext highlighter-rouge">mvn install</code>을 수행하면 된다.</p><p>이런 일련의 과정이 귀찮기에 <code class="language-plaintext highlighter-rouge">@AutoService</code>어노테이션을 사용하면 위의 문제를 해결해줄 수 있다. 컴파일 시점에 어노테이션 프로세서를 활용해서 파일을 자동으로 생성해주는 것이다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215277667-01cdae6b-abca-4b7d-9f19-409553c8ed87.png" alt="image" data-proofer-ignore></p><p>이제 <code class="language-plaintext highlighter-rouge">process()</code>에 로직을 구성해줘야한다.</p><h3 id="13-init-구현"><span class="mr-2">1.3 <code class="language-plaintext highlighter-rouge"><span class="mr-2">init()</code> 구현</span><a href="#13-init-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>    <span class="kd">private</span> <span class="nc">ProcessingEnvironment</span> <span class="n">processingEnvironment</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Trees</span> <span class="n">trees</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">TreeMaker</span> <span class="n">treeMaker</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Names</span> <span class="n">names</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Context</span> <span class="n">context</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">ProcessingEnvironment</span> <span class="n">processingEnv</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">JavacProcessingEnvironment</span> <span class="n">javacProcessingEnvironment</span> <span class="o">=</span> <span class="o">(</span><span class="nc">JavacProcessingEnvironment</span><span class="o">)</span> <span class="n">processingEnv</span><span class="o">;</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">processingEnv</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">processingEnvironment</span> <span class="o">=</span> <span class="n">processingEnv</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">trees</span> <span class="o">=</span> <span class="nc">Trees</span><span class="o">.</span><span class="na">instance</span><span class="o">(</span><span class="n">processingEnv</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">context</span> <span class="o">=</span> <span class="n">javacProcessingEnvironment</span><span class="o">.</span><span class="na">getContext</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">treeMaker</span> <span class="o">=</span> <span class="nc">TreeMaker</span><span class="o">.</span><span class="na">instance</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">names</span> <span class="o">=</span> <span class="nc">Names</span><span class="o">.</span><span class="na">instance</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">process()</code>를 구현하기 전에 필요한 정보들을 설정해야한다. 그에 대한 정보를 맞춰주는 메서드다.</p><p><code class="language-plaintext highlighter-rouge">JavacProcessingEnvironment javacProcessingEnvironment = (JavacProcessingEnvironment) processingEnv;</code>이 부분 코드 때문에 에러가 발생한다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215315151-925c802b-b299-4e6d-a3a4-7d8c44231b29.png" alt="image" data-proofer-ignore></p><p>이러한 에러로, <a href="https://github.com/mplushnikov/lombok-intellij-plugin/issues/988">https://github.com/mplushnikov/lombok-intellij-plugin/issues/988</a>를 참고하여 해결하면 된다.</p><ul><li><code class="language-plaintext highlighter-rouge">javacProcessingEnvironment.getContext()</code>에서 반환하는 컨택스트는 컴파일러 정보, 등을 반환하고 또한 해당 컨택스트를 통해 메서드나 클래스, 어노테이션 프로세서를 만들 수 있게 도와주는 정보를 제공한다.</ul><p>다른 변수들은 밑에서 어떻게 쓰이는지 확인하면서 찾아가보는게 낫겠다 생각했다.</p><h3 id="14-process-구현"><span class="mr-2">1.4 <code class="language-plaintext highlighter-rouge"><span class="mr-2">process()</code> 구현</span><a href="#14-process-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>
<span class="k">for</span> <span class="o">(</span><span class="kd">final</span> <span class="nc">Element</span> <span class="n">element</span> <span class="o">:</span> <span class="n">roundEnv</span><span class="o">.</span><span class="na">getElementsAnnotatedWith</span><span class="o">(</span><span class="nc">Get</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"element:"</span> <span class="o">+</span> <span class="n">element</span><span class="o">);</span>
            <span class="k">if</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">getKind</span><span class="o">()</span> <span class="o">!=</span> <span class="nc">ElementKind</span><span class="o">.</span><span class="na">CLASS</span><span class="o">){</span>
                <span class="n">processingEnv</span><span class="o">.</span><span class="na">getMessager</span><span class="o">().</span><span class="na">printMessage</span><span class="o">(</span><span class="nc">Diagnostic</span><span class="o">.</span><span class="na">Kind</span><span class="o">.</span><span class="na">ERROR</span><span class="o">,</span> <span class="s">"@Get annotation cant be used on"</span> <span class="o">+</span> <span class="n">element</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">());</span>
            <span class="o">}</span><span class="k">else</span><span class="o">{</span>
                <span class="n">processingEnv</span><span class="o">.</span><span class="na">getMessager</span><span class="o">().</span><span class="na">printMessage</span><span class="o">(</span><span class="nc">Diagnostic</span><span class="o">.</span><span class="na">Kind</span><span class="o">.</span><span class="na">NOTE</span><span class="o">,</span> <span class="s">"@Get annotation Processing "</span> <span class="o">+</span> <span class="n">element</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">());</span>
                <span class="kd">final</span> <span class="nc">TreePath</span> <span class="n">path</span> <span class="o">=</span> <span class="n">trees</span><span class="o">.</span><span class="na">getPath</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
                <span class="n">scanner</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">path</span><span class="o">.</span><span class="na">getCompilationUnit</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>

</pre></table></code></div></div><p>이 코드는 어렵지는 않다. 저 <code class="language-plaintext highlighter-rouge">for</code>문은 프로젝트 내에 있는 모든 파일의 클래스를 검사해 <code class="language-plaintext highlighter-rouge">Get</code>어노테이션이 붙어 있는것만 가져오는 문장이다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215317922-3f50d976-f820-44bf-a8b2-56dcc5ba7119.png" alt="image" data-proofer-ignore></p><p>이렇듯 다른 패키지나 다른 곳에 클래스가 있어도</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215317938-d1cd6223-e84c-4b07-8860-a99ad8e10179.png" alt="image" data-proofer-ignore></p><p>컴파일할 때 <code class="language-plaintext highlighter-rouge">@Get</code>어노테이션이 있으면 가져온다.</p><p>가져오고 나서는 <code class="language-plaintext highlighter-rouge">element.getKind() != ElementKind.CLASS</code>라는 문구를 통해 해당 어노테이션이 <strong>클래스</strong>타입에 붙어있는지 확인하고 맞다면 <code class="language-plaintext highlighter-rouge">else</code>문을, 아니면 <code class="language-plaintext highlighter-rouge">if</code>문을 진행하여 에러를 발생시키고 끝내버린다.</p><p>내가 <code class="language-plaintext highlighter-rouge">InterfaceLombok</code>이라는 인터페이스를 만들고, <code class="language-plaintext highlighter-rouge">@Get</code> 어노테이션을 달았다면 컴파일할 때 에러가 뜰 것이다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215318053-0a84448c-8d1a-4b43-afce-f512fd99d899.png" alt="image" data-proofer-ignore></p><h3 id="final-treepath-path--treesgetpathelement"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">final TreePath path = trees.getPath(element);</code></span><a href="#final-treepath-path--treesgetpathelement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>TreePath</strong>란 자바 프로그램에서 사용되는 코드, 메서드, 클래스, 변수등을 하나의 트리형태의 자료구조로 관리하는 클래스이다.</p><p>그래서 <code class="language-plaintext highlighter-rouge">getPath()</code>메소드를 통해 개발자가 원하는 특정 노드의 경로를 찾을 수 있다.</p><p>이를 출력하려면 <code class="language-plaintext highlighter-rouge">getPathCoponent()</code>메서드를 통해 호출 할 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">//..위에 for문으로 @Get이 달린 모든 요소들을 element에 넣고 있다.</span>
<span class="kd">final</span> <span class="nc">TreePath</span> <span class="n">path</span> <span class="o">=</span> <span class="n">trees</span><span class="o">.</span><span class="na">getPath</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path</span><span class="o">.</span><span class="na">getCompilationUnit</span><span class="o">());</span>
<span class="c1">//scanner.scan(path, path.getCompilationUnit());</span>
</pre></table></code></div></div><p>실제로 이를 호출해보면</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215502751-de0b27e3-a62a-40dc-997e-4a5c4d6cf750.png" alt="image" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">@Get</code>어노테이션이 달린 파일의 소스코드를 모두 가지고 있음을 알 수 있다. 여담으로 컴파일러가 생성자가 없는 경우에는 기본 생성자도 알아서 만들어주고, 한글 문자가 유니코드로 변환됨을 알 수 있다.</p><h3 id="scannerscanpath-pathgetcompilationunit"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">scanner.scan(path, path.getCompilationUnit());</code></span><a href="#scannerscanpath-pathgetcompilationunit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>scanner는 위에서 변수로 작성되어있는데, 어떻게 작성되어있는지 보겠다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="nc">TreePathScanner</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">,</span> <span class="nc">CompilationUnitTree</span><span class="o">&gt;</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreePathScanner</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">,</span> <span class="nc">CompilationUnitTree</span><span class="o">&gt;(){</span>
            
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="nc">Trees</span> <span class="nf">visitClass</span><span class="o">(</span><span class="nc">ClassTree</span> <span class="n">classTree</span><span class="o">,</span> <span class="nc">CompilationUnitTree</span> <span class="n">unitTree</span><span class="o">){</span>
                <span class="nc">JCTree</span><span class="o">.</span><span class="na">JCCompilationUnit</span> <span class="n">compilationUnit</span> <span class="o">=</span> <span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCCompilationUnit</span><span class="o">)</span> <span class="n">unitTree</span><span class="o">;</span>
                <span class="c1">// .java 파일인지 확인후 accept 를 통해 treeTransLator, 작성 메소드 생성</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">compilationUnit</span><span class="o">.</span><span class="na">sourcefile</span><span class="o">.</span><span class="na">getKind</span><span class="o">()</span> <span class="o">==</span> <span class="nc">JavaFileObject</span><span class="o">.</span><span class="na">Kind</span><span class="o">.</span><span class="na">SOURCE</span><span class="o">){</span>
                    <span class="n">compilationUnit</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="k">new</span> <span class="nc">TreeTranslator</span><span class="o">()</span> <span class="o">{</span>
                        <span class="nd">@Override</span>
                        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitClassDef</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCClassDecl</span> <span class="n">jcClassDecl</span><span class="o">)</span> <span class="o">{</span>
                            <span class="kd">super</span><span class="o">.</span><span class="na">visitClassDef</span><span class="o">(</span><span class="n">jcClassDecl</span><span class="o">);</span>
                            <span class="c1">// Class 내부에 정의된 모든 member 를 싹다 가져옴.</span>
                            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">getMembers</span><span class="o">();</span>
                            <span class="c1">// Syntax tree 에서 모든 member 변수 get</span>
                            <span class="k">for</span><span class="o">(</span><span class="nc">JCTree</span> <span class="n">member</span> <span class="o">:</span> <span class="n">members</span><span class="o">){</span>
                                <span class="k">if</span> <span class="o">(</span><span class="n">member</span> <span class="k">instanceof</span> <span class="nc">JCTree</span><span class="o">.</span><span class="na">JCVariableDecl</span><span class="o">){</span>
                                    <span class="c1">// member 변수에 대한 getter 메서드 생성</span>
                                    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCMethodDecl</span><span class="o">&gt;</span> <span class="n">getters</span> <span class="o">=</span> <span class="n">createGetter</span><span class="o">((</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCVariableDecl</span><span class="o">)</span> <span class="n">member</span><span class="o">);</span>
                                    <span class="k">for</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCMethodDecl</span> <span class="n">getter</span> <span class="o">:</span> <span class="n">getters</span><span class="o">){</span>
                                        <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">defs</span> <span class="o">=</span> <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">defs</span><span class="o">.</span><span class="na">prepend</span><span class="o">(</span><span class="n">getter</span><span class="o">);</span>
                                    <span class="o">}</span>
                                <span class="o">}</span>
                            <span class="o">}</span>
                        <span class="o">}</span>
                    <span class="o">});</span>
                <span class="o">}</span>
                <span class="k">return</span> <span class="n">trees</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">};</span>
</pre></table></code></div></div><p>이 코드를 하나씩 까볼 필요가 있다.</p><h3 id="treepathscannerobject-compilationunittree"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">TreePathScanner&lt;Object, CompilationUnitTree&gt;</code></span><a href="#treepathscannerobject-compilationunittree" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>이 클래스는 자바 컴파일러API가 제공하는 클래스로, 자바 소스 트리 구조를 순회하면서 개발자의 명령어를 수행할 수 있는 트리구조이다.</p><p>각 요소에 대해서, 첫 번째 자료형은 해당 클래스의 <strong>리턴</strong>타입을 말하고, 두 번째 자료형은 <strong>트리의 루트 요소 타입</strong>을 말한다.</p><p>즉, 이 클래스는 <code class="language-plaintext highlighter-rouge">Object</code>형을 반환할 것이고, 트리의 루트 요소 타입은 <code class="language-plaintext highlighter-rouge">ComilationUnitTree</code>타입이 될 것이다.</p><p>그리고 이는 <code class="language-plaintext highlighter-rouge">visitClass()</code>를 오버라이드 하게 되어있는데 이는</p><p><code class="language-plaintext highlighter-rouge">scanner.scan(path, path.getCompilationUnit());</code>이 소스에서 호출하고 있다.</p><p>디버그를 찍어보면</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215509661-fbc8b052-a5ea-4c87-ad70-56fc6a0a915a.png" alt="image" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">scan()</code>메소드의 <code class="language-plaintext highlighter-rouge">accept()</code>라는 메서드가 있는데, 이 부분을 들어가게 되면</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215510743-b6f589bc-6dfb-4c96-bc27-f174acfde345.png" alt="image" data-proofer-ignore></p><p>오버라이드한 <code class="language-plaintext highlighter-rouge">visitClass()</code>를 호출하게 되어있다.</p><p><code class="language-plaintext highlighter-rouge">public Trees visitClass(ClassTree classTree, CompilationUnitTree unitTree)</code>에서 그러면 <code class="language-plaintext highlighter-rouge">classTree</code>는 무엇이고, <code class="language-plaintext highlighter-rouge">unitTree</code>는 무엇인가</p><p><code class="language-plaintext highlighter-rouge">classTree</code>는 패키지, 임포트 문을 제외한 자바 소스코드 그 자체이고, <code class="language-plaintext highlighter-rouge">unitTree</code>는 패키지, 임포트문을 포함한 자바 소스 코드이다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c1">//classTree</span>

<span class="nd">@Get</span><span class="o">()</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nf">Test</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//unitTree</span>
<span class="kn">package</span> <span class="nn">me.kms.animal</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">me.kms.anno.Get</span><span class="o">;</span>

<span class="nd">@Get</span><span class="o">()</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nf">Test</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>그 밑은 자바 코드인지 확인하고 맞다면 <code class="language-plaintext highlighter-rouge">TreeTranslator</code>클래스를 만들어서 특정 행동을 수행하게 된다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">// java파일인지 확인</span>
<span class="k">if</span> <span class="o">(</span><span class="n">compilationUnit</span><span class="o">.</span><span class="na">sourcefile</span><span class="o">.</span><span class="na">getKind</span><span class="o">()</span> <span class="o">==</span> <span class="nc">JavaFileObject</span><span class="o">.</span><span class="na">Kind</span><span class="o">.</span><span class="na">SOURCE</span><span class="o">){</span>
                    <span class="n">compilationUnit</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="k">new</span> <span class="nc">TreeTranslator</span><span class="o">()</span> <span class="o">{</span>
                        <span class="nd">@Override</span>
                        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitClassDef</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCClassDecl</span> <span class="n">jcClassDecl</span><span class="o">)</span> <span class="o">{</span>
                            <span class="kd">super</span><span class="o">.</span><span class="na">visitClassDef</span><span class="o">(</span><span class="n">jcClassDecl</span><span class="o">);</span>
                            <span class="c1">// Class 내부에 정의된 모든 member 를 싹다 가져옴.</span>
                            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">getMembers</span><span class="o">();</span>
                            <span class="c1">// Syntax tree 에서 모든 member 변수 get</span>
                            <span class="k">for</span><span class="o">(</span><span class="nc">JCTree</span> <span class="n">member</span> <span class="o">:</span> <span class="n">members</span><span class="o">){</span>
                                <span class="k">if</span> <span class="o">(</span><span class="n">member</span> <span class="k">instanceof</span> <span class="nc">JCTree</span><span class="o">.</span><span class="na">JCVariableDecl</span><span class="o">){</span>
                                    <span class="c1">// member 변수에 대한 getter 메서드 생성</span>
                                    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCMethodDecl</span><span class="o">&gt;</span> <span class="n">getters</span> <span class="o">=</span> <span class="n">createGetter</span><span class="o">((</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCVariableDecl</span><span class="o">)</span> <span class="n">member</span><span class="o">);</span>
                                    <span class="k">for</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCMethodDecl</span> <span class="n">getter</span> <span class="o">:</span> <span class="n">getters</span><span class="o">){</span>
                                        <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">defs</span> <span class="o">=</span> <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">defs</span><span class="o">.</span><span class="na">prepend</span><span class="o">(</span><span class="n">getter</span><span class="o">);</span>
                                    <span class="o">}</span>
                                <span class="o">}</span>
                            <span class="o">}</span>
                        <span class="o">}</span>
                    <span class="o">});</span>
                <span class="o">}</span>
</pre></table></code></div></div><p>즉, 우리는 다시 <code class="language-plaintext highlighter-rouge">visitClassDef()</code>가 언제 호출되는지, 호출 내용에 대해 알 필요가 있다.</p><ul><li>먼저, <code class="language-plaintext highlighter-rouge">compilationUnit.accept</code>로 들어갈 필요가 있다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">Visitor</span> <span class="n">var1</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">var1</span><span class="o">.</span><span class="na">visitTopLevel</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이렇게 구현되어있으며, 이를 또 타고 들어가면</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215526338-863e5e13-cece-4fd2-8f46-81032378e809.png" alt="image" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">translate()</code> 함수는</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span> <span class="kd">extends</span> <span class="nc">JCTree</span><span class="o">&gt;</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">translate</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">var1</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">var1</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="nc">List</span> <span class="n">var2</span> <span class="o">=</span> <span class="n">var1</span><span class="o">;</span> <span class="n">var2</span><span class="o">.</span><span class="na">nonEmpty</span><span class="o">();</span> <span class="n">var2</span> <span class="o">=</span> <span class="n">var2</span><span class="o">.</span><span class="na">tail</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">var2</span><span class="o">.</span><span class="na">head</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">translate</span><span class="o">((</span><span class="nc">JCTree</span><span class="o">)</span><span class="n">var2</span><span class="o">.</span><span class="na">head</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="k">return</span> <span class="n">var1</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>이렇게 구현되어있다. <code class="language-plaintext highlighter-rouge">var</code>는 import문과 소스코드를 나눈 스트링을 리스트로 가지고 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">//var1[0]</span>
<span class="kn">import</span> <span class="nn">me.kms.anno.Get</span><span class="o">;</span>

<span class="c1">//var1[1]</span>
<span class="nd">@Get</span><span class="o">()</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nf">Test</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>그래서 실질적으로 <code class="language-plaintext highlighter-rouge">var1</code>을 돌면서 <code class="language-plaintext highlighter-rouge">this.translate((JCTree)var2.head)</code>이 문장을 수행해준다.</p><p>여기서 <code class="language-plaintext highlighter-rouge">head</code>란 인덱스로 봐도 무방하다. <code class="language-plaintext highlighter-rouge">tail</code>은 끝의 인덱스를 지칭한다.</p><p>그래서 <code class="language-plaintext highlighter-rouge">this.translate()</code>도 봐야하는데,</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span> <span class="kd">extends</span> <span class="nc">JCTree</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">translate</span><span class="o">(</span><span class="no">T</span> <span class="n">var1</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">var1</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">var1</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="nc">JCTree</span> <span class="n">var2</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">result</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">var2</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이렇게 구현이 되어있다.</p><p>내부는 좀 더 복잡하지만, 간단하게 <code class="language-plaintext highlighter-rouge">import</code>로 선언된 경로를 하나하나 파싱해가면서 찾아가는 역할을한다. <strong>me.kms.anno.Get</strong>으로 되어있다면 <strong>me</strong>를 들리고 그다음 <strong>kms</strong>를 들리고 .. 이런 작업을 진행한다.</p><p>그래서 <code class="language-plaintext highlighter-rouge">import</code>문을 이렇게 찾아가고 위의 코드에서 <code class="language-plaintext highlighter-rouge">var1[1]</code>인 소스코드 부분도 <code class="language-plaintext highlighter-rouge">accept()</code>함수를 호출하게 처리하게 된다.</p><p>이는 좀 더 다르게 동작하는데, 그 이유는 둘의 자료형이 다르기 때문이다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215530654-b1246e13-6234-474c-923a-8f0d1808e736.png" alt="image" data-proofer-ignore></p><p>그래서 <code class="language-plaintext highlighter-rouge">var1[1]</code>은 <code class="language-plaintext highlighter-rouge">JCClassDecl</code>의 <code class="language-plaintext highlighter-rouge">accept()</code>를 호출하게 되는데 다음과 같이 구현되어있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">Visitor</span> <span class="n">var1</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">var1</span><span class="o">.</span><span class="na">visitClassDef</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>여기서 우리가 오버라이드해준 <code class="language-plaintext highlighter-rouge">vistiClassDef()</code>가 호출이 되는 것이다.</p><p>그럼 다시 돌아가야한다.</p><p>그래서 일단 오버라이드한 함수 인자로 임포트문을 제외한 소스코드가 있다고 인지하고 시작하자.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitClassDef</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCClassDecl</span> <span class="n">jcClassDecl</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">visitClassDef</span><span class="o">(</span><span class="n">jcClassDecl</span><span class="o">);</span>
    <span class="c1">// Class 내부에 정의된 모든 member 를 싹다 가져옴.</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">getMembers</span><span class="o">();</span>
    <span class="c1">// Syntax tree 에서 모든 member 변수 get</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">JCTree</span> <span class="n">member</span> <span class="o">:</span> <span class="n">members</span><span class="o">){</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">member</span> <span class="k">instanceof</span> <span class="nc">JCTree</span><span class="o">.</span><span class="na">JCVariableDecl</span><span class="o">){</span>
            <span class="c1">// member 변수에 대한 getter 메서드 생성</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCMethodDecl</span><span class="o">&gt;</span> <span class="n">getters</span> <span class="o">=</span> <span class="n">createGetter</span><span class="o">((</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCVariableDecl</span><span class="o">)</span> <span class="n">member</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCMethodDecl</span> <span class="n">getter</span> <span class="o">:</span> <span class="n">getters</span><span class="o">){</span>
                <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">defs</span> <span class="o">=</span> <span class="n">jcClassDecl</span><span class="o">.</span><span class="na">defs</span><span class="o">.</span><span class="na">prepend</span><span class="o">(</span><span class="n">getter</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>내부 구현을 보자</p><p><code class="language-plaintext highlighter-rouge">super.visitClassDef()</code>는 다음과 같이 구현되어 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitClassDef</span><span class="o">(</span><span class="nc">JCClassDecl</span> <span class="n">var1</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//어노테이션 정보를 가지고 있다.</span>
    <span class="n">var1</span><span class="o">.</span><span class="na">mods</span> <span class="o">=</span> <span class="o">(</span><span class="nc">JCModifiers</span><span class="o">)</span><span class="k">this</span><span class="o">.</span><span class="na">translate</span><span class="o">((</span><span class="nc">JCTree</span><span class="o">)</span><span class="n">var1</span><span class="o">.</span><span class="na">mods</span><span class="o">);</span>
    <span class="c1">//없음</span>
    <span class="n">var1</span><span class="o">.</span><span class="na">typarams</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">translateTypeParams</span><span class="o">(</span><span class="n">var1</span><span class="o">.</span><span class="na">typarams</span><span class="o">);</span>
    <span class="c1">//없음</span>
    <span class="n">var1</span><span class="o">.</span><span class="na">extending</span> <span class="o">=</span> <span class="o">(</span><span class="nc">JCExpression</span><span class="o">)</span><span class="k">this</span><span class="o">.</span><span class="na">translate</span><span class="o">((</span><span class="nc">JCTree</span><span class="o">)</span><span class="n">var1</span><span class="o">.</span><span class="na">extending</span><span class="o">);</span>
    <span class="c1">//없음</span>
    <span class="n">var1</span><span class="o">.</span><span class="na">implementing</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">translate</span><span class="o">(</span><span class="n">var1</span><span class="o">.</span><span class="na">implementing</span><span class="o">);</span>
    <span class="c1">//함수에 관한 정보</span>
    <span class="n">var1</span><span class="o">.</span><span class="na">defs</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">translate</span><span class="o">(</span><span class="n">var1</span><span class="o">.</span><span class="na">defs</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">result</span> <span class="o">=</span> <span class="n">var1</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>인자로 넘어온 값들을 가지고 초기화를 수행한다.</p><p>기존에는 빈 클래스를 예시르 들었지만, 이해를 돕기 위해 이번에는 멤버변수를 3개 가지고 있는 클래스를 가지고 디버그를 할 것이다.</p><ul><li><code class="language-plaintext highlighter-rouge">List&lt;JCTree&gt; members = jcClassDecl.getMembers();</code>이 구문은 간단하게 구현되어있다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">defs</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이렇게 간단하게 구현되어, 멤버 변수, 멤버 함수를 반환한다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215750908-10271631-f91b-4d1a-8e94-957a5bb9d0bc.png" alt="image" data-proofer-ignore></p><p>그 후, 멤버 변수면 해당 멤버 변수를 가지고 <code class="language-plaintext highlighter-rouge">Getter</code>를 만들게 되는데, 이 부분은 개발자가 직접 작성해주어야한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCMethodDecl</span><span class="o">&gt;</span> <span class="nf">createGetter</span><span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCVariableDecl</span> <span class="kt">var</span><span class="o">){</span>
        <span class="c1">// 필드 이름 변수에 앞문자 대문자로 변경 해주기</span>
        <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="kt">var</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">upperVar</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">()+</span><span class="n">str</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="kt">var</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>

        <span class="k">return</span> <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="cm">/**
                 * treeMaker.Modifiers -&gt; syntax tree node 에 접근하여 수정및 삽입하는 역할
                 * @Parm : treeMaker.Modifiers flag 1-&gt; public , 2-&gt; private, 0-&gt; default
                 * @Parm : methodName &amp; Type, return 정의
                 */</span>
                <span class="n">treeMaker</span><span class="o">.</span><span class="na">MethodDef</span><span class="o">(</span>
                        <span class="n">treeMaker</span><span class="o">.</span><span class="na">Modifiers</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="c1">// public</span>
                        <span class="n">names</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"get"</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="n">upperVar</span><span class="o">)),</span> <span class="c1">// 메서드 명</span>
                        <span class="o">(</span><span class="nc">JCTree</span><span class="o">.</span><span class="na">JCExpression</span><span class="o">)</span> <span class="kt">var</span><span class="o">.</span><span class="na">getType</span><span class="o">(),</span> <span class="c1">// return type</span>
                        <span class="nc">List</span><span class="o">.</span><span class="na">nil</span><span class="o">(),</span>
                        <span class="nc">List</span><span class="o">.</span><span class="na">nil</span><span class="o">(),</span>
                        <span class="nc">List</span><span class="o">.</span><span class="na">nil</span><span class="o">(),</span>
                        <span class="c1">// 식생성 this.a = a;</span>
                        <span class="n">treeMaker</span><span class="o">.</span><span class="na">Block</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">treeMaker</span><span class="o">.</span><span class="na">Return</span><span class="o">((</span><span class="n">treeMaker</span><span class="o">.</span><span class="na">Ident</span><span class="o">(</span><span class="kt">var</span><span class="o">.</span><span class="na">getName</span><span class="o">()))))),</span>
                        <span class="kc">null</span><span class="o">));</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>대부분의 내용은 주석을 보면 이해가 되지만 <code class="language-plaintext highlighter-rouge">treeMaker.Block()</code> 메서드 생성 부분은 짚고 넘어갈만하다.</p><p>이 함수는 <strong>함수 블럭</strong>을 만드는 함수로,</p><ul><li>첫 번째 인자값은 접근 지정자이다. 1은 <strong>public</strong>을 의미한다.<li>두 번째 인자값은 <strong>리스트</strong>를 주어야하고, 블록 한 줄을 작성할 수 있게 한다. 저 구문에서는 리턴 값에 쓸 문자열을 지정해준것이다.</ul><p>결국,</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">age</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이런 구문이 만들어질 것이다.</p><p>그래서 결국, treeMaker에서 제공하는 <code class="language-plaintext highlighter-rouge">MethodDef()</code>메서드를 통해</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAge</span><span class="o">()</span> <span class="kd">public</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">age</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>를 반환하게 된다.</p><p>이렇게 모든 멤버변수를 돌면서 <code class="language-plaintext highlighter-rouge">getter</code>를 만들고, 이를 JCTree에 넣어준다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215760379-300babb5-d2f4-42aa-a910-a58bfc6cbffe.png" alt="image" data-proofer-ignore></p><p>그렇게 트리로 만들어진 코드는 컴파일 되어서 클래스 파일로 만들어진다.</p><p><img data-src="https://user-images.githubusercontent.com/30401054/215761501-ef11bd04-4e86-4d5d-8a2c-3fb070c8f60e.png" alt="image" data-proofer-ignore></p><p>다음엔 이 방식으로 Getter를 만들어보겠다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/interview/'>Interview</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/interview/" class="post-tag no-text-decoration" >interview</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Java Lombok @Get 직접 구현해보면서 프로세서 분석하기. - 민석강&amp;url=https://kkminseok.github.io/posts/2023-01-31-Annotation_AD/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Java Lombok @Get 직접 구현해보면서 프로세서 분석하기. - 민석강&amp;u=https://kkminseok.github.io/posts/2023-01-31-Annotation_AD/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://kkminseok.github.io/posts/2023-01-31-Annotation_AD/&amp;text=Java Lombok @Get 직접 구현해보면서 프로세서 분석하기. - 민석강" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/2023-03-06-dnd/">DND 8기 활동 후기</a><li><a href="/posts/2024-03-31-fastapi/">fastapi Swagger Response 분리하기</a><li><a href="/posts/2023-05-19-think01/">5월19일시점 개발하면서 고민한 것들 + 도커관련 이슈</a><li><a href="/posts/2023-05-02-Modern-Java-In-action/">2번 읽는 Modern Java In Action - Chapter06 스트림으로 데이터 수집</a><li><a href="/posts/2023-03-18-Modern-Java-In-Action/">2번 읽는 Modern Java In Action - Chapter01 기초</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/algorithmstudy/">AlgorithmStudy</a> <a class="post-tag" href="/tags/top100like/">Top100Like</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/fastapi/">FastAPI</a> <a class="post-tag" href="/tags/economy/">Economy</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/top100interview/">Top100Interview</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/20221207InterviewBook01/"><div class="card-body"> <em class="timeago small" data-ts="1670346120" > 2022-12-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 1장 - 사용자 수에 따른 규모 확장성</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 원준이라는 친구가 나 공부 열심히하라고 책을 선물해줬다. 읽어보도록 했다. 1장은 한 명의 사용자를 지원하는 시스템에서 시작한다. ✏️ 단일 서버 웹브라우저, 웹 서버, DNS가 있을때 사용자의 요청 (웹 브라우저에서 요청을 보냄)이 어떻게 처리되는지를 알...</p></div></div></a></div><div class="card"> <a href="/posts/20221208InterviewBook02/"><div class="card-body"> <em class="timeago small" data-ts="1670432520" > 2022-12-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 2장 - 개략적인 규모 추정</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 이 장은 시스템 용량이나 성능 요구사항을 개략적으로 측정하는 방법에 대해 다룬다. 개략적 규모 추정을 효과적으로 필요한 기본기에 능숙해야 한다. 특히, 2의 제곱수나 응답지연(latency) 값, 그리고 가용성에 관계된 수치들을 기본적으로 잘 이해하고 있어야 한다고...</p></div></div></a></div><div class="card"> <a href="/posts/2022-12-09-InterviewBoo03/"><div class="card-body"> <em class="timeago small" data-ts="1670515320" > 2022-12-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>가상 면접 사례로 배우는 대규모 시스템 설계 기초 3장 - 시스템 설계 면접 공략법</h3><div class="text-muted small"><p> 가상 면접 사례로 배우는 대규모 시스템 설계 기초 책 정리 글입니다. 개요 시스템 설계 면접은 두 명의 동료가 모호한 문제를 풀기 위해 협력하여 해결책을 찾아가는 과정이다. 때문에 정답도 없고 결과도 없다. 설계과정에서 내린 결정에 대해 방어하는 능력을 보는 과정이고, 면접관의 피드백을 건설적인 방향으로 처리할 자질이 있음을 보는 면접이다....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/2023-01-26-Annotation_Ad01/" class="btn btn-outline-primary" prompt="Older"><p>Java Annotation 쓰는이유 중 하나</p></a> <a href="/posts/2023-02-26-dockerError/" class="btn btn-outline-primary" prompt="Newer"><p>Trouble Shooting - Docker 빌드할때 운영체제를 꼼꼼히 봐야한다.</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "kkminseok/kkminseok.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkzNDUwNzI2OTM=", "data-category": "Announcements", "data-category-id": "DIC_kwDOFJFkNc4CO5-J", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/none">kang minseok</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/algorithmstudy/">AlgorithmStudy</a> <a class="post-tag" href="/tags/top100like/">Top100Like</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/fastapi/">FastAPI</a> <a class="post-tag" href="/tags/economy/">Economy</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/top100interview/">Top100Interview</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KMXXJ0D586"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KMXXJ0D586'); }); </script>
